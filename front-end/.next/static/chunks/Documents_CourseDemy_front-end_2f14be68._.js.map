{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/components/cart/CartItemDisplay.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useEffect, useState } from \"react\";\nimport { useApi } from \"@/hooks/useApi\";\nimport { Button } from \"../ui/button\";\nimport { ArrowRight } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { useAppSelector } from \"@/redux/hooks\";\nimport { useRouter } from \"next/navigation\";\nimport { da } from \"zod/v4/locales\";\n\nconst CartItemDisplay = () => {\n  const router = useRouter();\n  const user = useAppSelector((state) => state.auth.user);\n  const { get, remove, post } = useApi();\n\n  const [cartItems, setCartItems] = useState<any[]>([]);\n  const [courseIds, setCourseIds] = useState<any[]>([]);\n  const [total, setTotal] = useState(0);\n\n  // Lấy giỏ hàng\n  const getCoursesInCart = async () => {\n    if (!user?.id) return;\n\n    try {\n      const data = await get(`/cart/user/${user.id}`);\n      const items = Array.isArray(data?.cart_items) ? data.cart_items : [];\n\n      // Gọi API lấy thông tin từng khóa học\n      const detailedItems = await Promise.all(\n        items.map(async (item: any) => {\n          try {\n            const course = await get(`/course/${item.course_id}`);\n\n            return {\n              ...item,\n              title: course.title,\n              level: course.level,\n              teacher_name: course.teacher_name,\n            };\n          } catch {\n            return { ...item, title: `Khóa học #${item.course_id}` };\n          }\n        })\n      );\n\n      setCartItems(detailedItems);\n      setCourseIds(detailedItems.map((i) => i.course_id));\n\n      // Tính tổng\n      const totalAmount = detailedItems.reduce(\n        (sum: number, item: any) =>\n          sum + (item.price || 0) * (item.quantity || 1),\n        0\n      );\n      setTotal(totalAmount);\n    } catch (err) {\n      toast.error(\"Lỗi khi lấy giỏ hàng: \" + err);\n      setCartItems([]);\n      setTotal(0);\n    }\n  };\n\n  // Xoá khóa học khỏi giỏ\n  const handleRemove = async (course_id: number) => {\n    if (!user?.id) {\n      toast.error(\"Bạn chưa đăng nhập!\");\n      return;\n    }\n\n    try {\n      await remove(`/cart/remove?userId=${user.id}&courseId=${course_id}`);\n      getCoursesInCart(); // load lại\n    } catch (error) {\n      toast.error(\"Xoá thất bại!\");\n    }\n  };\n\n  //\n  const handleCreateOrder = async () => {\n    const body = {\n      user_id: user?.id,\n      course_id: courseIds,\n      payment_method: \"momo\",\n    };\n\n    try {\n      const data = await post(\"/checkout/cart\", body);\n      console.log(data);\n      router.push(\"/payment/checkout\");\n    } catch (err) {\n      toast.error(\"Lỗi: \" + err || \"Có lỗi xảy ra\");\n    }\n  };\n\n  useEffect(() => {\n    getCoursesInCart();\n  }, [user?.id]);\n\n  return (\n    <div className=\"flex gap-6 p-4 cursor-pointer\">\n      {/* Bên trái: danh sách khóa học */}\n      <div className=\"flex-1\">\n        <h5 className=\"font-semibold text-lg mb-5 border-b\">\n          Có {cartItems.length} khóa học trong giỏ hàng\n        </h5>\n\n        <div className=\"space-y-3\">\n          {cartItems.map((item, index) => (\n            <div\n              key={index}\n              className=\"border p-3 rounded flex justify-between\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-[100px] h-[60px] bg-gray-200 rounded\"></div>\n                <div>\n                  <h3 className=\"font-semibold\">{item.title}</h3>\n                  <p className=\"text-sm text-gray-600\">\n                    Bởi {item.teacher_name}\n                  </p>\n                  <span className=\"text-xs text-gray-500\">\n                    Cấp độ: {item.level}\n                  </span>\n                </div>\n              </div>\n\n              <div className=\"flex gap-6\">\n                <span\n                  onClick={() => handleRemove(item.course_id)}\n                  className=\"text-sm text-red-500 hover:underline\"\n                >\n                  Xoá\n                </span>\n                <span className=\"font-semibold\">\n                  {item.price?.toLocaleString()} đ\n                </span>\n              </div>\n            </div>\n          ))}\n\n          {cartItems.length === 0 && (\n            <p className=\"text-gray-500 italic text-center mt-6\">\n              Giỏ hàng trống\n            </p>\n          )}\n        </div>\n      </div>\n\n      {/* Bên phải: tổng tiền */}\n      <div className=\"min-w-[300px] p-4 h-fit\">\n        <h2 className=\"font-semibold text-lg mb-2\">Tổng tiền</h2>\n        <h1 className=\"text-2xl font-bold text-red-600 mb-[30px]\">\n          {total.toLocaleString()} đ\n        </h1>\n\n        <Button\n          className=\"w-full h-[50px] cursor-pointer\"\n          onClick={handleCreateOrder}\n        >\n          Thanh toán <ArrowRight className=\"ml-2\" />\n        </Button>\n        <p className=\"text-sm text-[#3d2626] my-2\">\n          Bạn sẽ không bị tính phí ngay bây giờ\n        </p>\n        <hr />\n      </div>\n    </div>\n  );\n};\n\nexport default CartItemDisplay;\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 325, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/Documents/CourseDemy/front-end/node_modules/lucide-react/dist/esm/icons/arrow-right.js","sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/node_modules/lucide-react/src/icons/arrow-right.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'm12 5 7 7-7 7', key: 'xquz4c' }],\n];\n\n/**\n * @component @name ArrowRight\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJtMTIgNSA3IDctNyA3IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/arrow-right\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowRight = createLucideIcon('arrow-right', __iconNode);\n\nexport default ArrowRight;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAY,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;IACzC;QAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAQ,CAAA;YAAE,GAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YAAiB,CAAA,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA,CAAU;KAAA;CAChD;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,KAAa,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,4MAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAe,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA","debugId":null}}]
}