{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/components/theme-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport * as React from \"react\";\nimport { ThemeProvider as NextThemesProvider } from \"next-themes\";\n\nexport function ThemeProvider({\n  children,\n  ...props\n}: React.ComponentProps<typeof NextThemesProvider>) {\n  return <NextThemesProvider {...props}>{children}</NextThemesProvider>;\n}\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAKO,SAAS,cAAc,EAC5B,QAAQ,EACR,GAAG,OAC6C;IAChD,qBAAO,yRAAC,4MAAkB;QAAE,GAAG,KAAK;kBAAG;;;;;;AACzC","debugId":null}},
    {"offset": {"line": 33, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/features/cart/cartThunk.ts"],"sourcesContent":["import { createAsyncThunk } from \"@reduxjs/toolkit\";\n\nexport const fetchCartThunk = createAsyncThunk(\n  \"cart/fetch\",\n  async ({ userId, token }: { userId: number; token: string }) => {\n    const res = await fetch(\n      `${process.env.NEXT_PUBLIC_API_URL}/cart/user/${userId}`,\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n\n    const data = await res.json();\n    return Array.isArray(data?.cart_items)\n      ? data.cart_items.map((i: any) => i.course_id)\n      : [];\n  }\n);\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,iBAAiB,IAAA,0PAAgB,EAC5C,cACA,OAAO,EAAE,MAAM,EAAE,KAAK,EAAqC;IACzD,MAAM,MAAM,MAAM,MAChB,6DAAmC,WAAW,EAAE,QAAQ,EACxD;QACE,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC;IAC9C;IAGF,MAAM,OAAO,MAAM,IAAI,IAAI;IAC3B,OAAO,MAAM,OAAO,CAAC,MAAM,cACvB,KAAK,UAAU,CAAC,GAAG,CAAC,CAAC,IAAW,EAAE,SAAS,IAC3C,EAAE;AACR","debugId":null}},
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/features/auth/authThunks.ts"],"sourcesContent":["import { createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { fetchCartThunk } from \"../cart/cartThunk\";\n\n// ---- LOGIN ----\nexport const loginUserThunk = createAsyncThunk(\n  \"auth/login\",\n  async (\n    credentials: { email: string; password: string },\n    { rejectWithValue, dispatch }\n  ) => {\n    try {\n      const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/login`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(credentials),\n      });\n\n      if (!res.ok) {\n        const error = await res.json().catch(() => ({}));\n        return rejectWithValue(error.message || \"Sai tài khoản hoặc mật khẩu\");\n      }\n\n      const data = await res.json();\n      const token = data.token;\n      const decoded = jwtDecode(data.token);\n      dispatch(fetchCartThunk({ userId: decoded.id, token }));\n\n      return data.token;\n    } catch (err: any) {\n      return rejectWithValue(err.message);\n    }\n  }\n);\n\n// ---- LOGOUT ----\nexport const logoutThunk = createAsyncThunk(\"auth/logout\", async () => {\n  localStorage.removeItem(\"token\");\n});\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAGO,MAAM,iBAAiB,IAAA,0PAAgB,EAC5C,cACA,OACE,aACA,EAAE,eAAe,EAAE,QAAQ,EAAE;IAE7B,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,6DAAmC,MAAM,CAAC,EAAE;YAClE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,QAAQ,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC9C,OAAO,gBAAgB,MAAM,OAAO,IAAI;QAC1C;QAEA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,QAAQ,KAAK,KAAK;QACxB,MAAM,UAAU,IAAA,8MAAS,EAAC,KAAK,KAAK;QACpC,SAAS,IAAA,iMAAc,EAAC;YAAE,QAAQ,QAAQ,EAAE;YAAE;QAAM;QAEpD,OAAO,KAAK,KAAK;IACnB,EAAE,OAAO,KAAU;QACjB,OAAO,gBAAgB,IAAI,OAAO;IACpC;AACF;AAIK,MAAM,cAAc,IAAA,0PAAgB,EAAC,eAAe;IACzD,aAAa,UAAU,CAAC;AAC1B","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/features/auth/authSlice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { loginUserThunk, logoutThunk } from \"./authThunks\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { fetchCartThunk } from \"../cart/cartThunk\";\n\n// Interface định nghĩa user lấy từ payload token\nimport { User } from \"@/types/userType\";\n\n//  Interface định nghĩa cấu trúc state\ninterface AuthState {\n  token: string | null;\n  user: User | null;\n  loading: boolean;\n  error: string | null;\n}\n\n//  State khởi tạo\nconst initialState: AuthState = {\n  token: null,\n  user: null,\n  loading: false,\n  error: null,\n};\n\n//  Tạo Slice\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    clearError: (state) => {\n      state.error = null;\n    },\n    // Dùng khi reload trang (ReduxProvider khôi phục)\n    setCredentials: (\n      state,\n      action: PayloadAction<{ token: string; user: User }>\n    ) => {\n      state.token = action.payload.token;\n      state.user = action.payload.user;\n    },\n  },\n  extraReducers: (builder) => {\n    //  LOGIN\n    builder\n      .addCase(loginUserThunk.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(\n        loginUserThunk.fulfilled,\n        (state, action: PayloadAction<string>) => {\n          state.loading = false;\n          state.token = action.payload;\n\n          try {\n            // Giải mã token lấy thông tin user\n            const decodedUser = jwtDecode<User>(action.payload);\n            state.user = decodedUser;\n\n            // Lưu localStorage\n            localStorage.setItem(\"token\", action.payload);\n            localStorage.setItem(\"user\", JSON.stringify(decodedUser));\n          } catch {\n            console.error(\"Token không hợp lệ\");\n          }\n        }\n      )\n      .addCase(loginUserThunk.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.error.message || \"Đăng nhập thất bại\";\n      });\n\n    //  LOGOUT\n    builder.addCase(logoutThunk.fulfilled, (state) => {\n      state.token = null;\n      state.user = null;\n      state.error = null;\n\n      localStorage.removeItem(\"token\");\n      localStorage.removeItem(\"user\");\n    });\n  },\n});\n\nexport const { clearError, setCredentials } = authSlice.actions;\nexport default authSlice.reducer;\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;AAcA,kBAAkB;AAClB,MAAM,eAA0B;IAC9B,OAAO;IACP,MAAM;IACN,SAAS;IACT,OAAO;AACT;AAEA,aAAa;AACb,MAAM,YAAY,IAAA,qPAAW,EAAC;IAC5B,MAAM;IACN;IACA,UAAU;QACR,YAAY,CAAC;YACX,MAAM,KAAK,GAAG;QAChB;QACA,kDAAkD;QAClD,gBAAgB,CACd,OACA;YAEA,MAAM,KAAK,GAAG,OAAO,OAAO,CAAC,KAAK;YAClC,MAAM,IAAI,GAAG,OAAO,OAAO,CAAC,IAAI;QAClC;IACF;IACA,eAAe,CAAC;QACd,SAAS;QACT,QACG,OAAO,CAAC,kMAAc,CAAC,OAAO,EAAE,CAAC;YAChC,MAAM,OAAO,GAAG;YAChB,MAAM,KAAK,GAAG;QAChB,GACC,OAAO,CACN,kMAAc,CAAC,SAAS,EACxB,CAAC,OAAO;YACN,MAAM,OAAO,GAAG;YAChB,MAAM,KAAK,GAAG,OAAO,OAAO;YAE5B,IAAI;gBACF,mCAAmC;gBACnC,MAAM,cAAc,IAAA,8MAAS,EAAO,OAAO,OAAO;gBAClD,MAAM,IAAI,GAAG;gBAEb,mBAAmB;gBACnB,aAAa,OAAO,CAAC,SAAS,OAAO,OAAO;gBAC5C,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;YAC9C,EAAE,OAAM;gBACN,QAAQ,KAAK,CAAC;YAChB;QACF,GAED,OAAO,CAAC,kMAAc,CAAC,QAAQ,EAAE,CAAC,OAAO;YACxC,MAAM,OAAO,GAAG;YAChB,MAAM,KAAK,GAAG,OAAO,KAAK,CAAC,OAAO,IAAI;QACxC;QAEF,UAAU;QACV,QAAQ,OAAO,CAAC,+LAAW,CAAC,SAAS,EAAE,CAAC;YACtC,MAAM,KAAK,GAAG;YACd,MAAM,IAAI,GAAG;YACb,MAAM,KAAK,GAAG;YAEd,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;QAC1B;IACF;AACF;AAEO,MAAM,EAAE,UAAU,EAAE,cAAc,EAAE,GAAG,UAAU,OAAO;uCAChD,UAAU,OAAO","debugId":null}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/features/course/courseSlice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\n\ninterface CourseState {\n  courseId: number | null;\n  courseTitle: string | \"\";\n}\n\nconst initialState: CourseState = {\n  courseId: null,\n  courseTitle: \"\",\n};\n\nconst courseSlice = createSlice({\n  name: \"course\",\n  initialState,\n  reducers: {\n    setCourse: (\n      state,\n      action: PayloadAction<{ courseId: number; courseTitle: string }>\n    ) => {\n      state.courseId = action.payload.courseId;\n      state.courseTitle = action.payload.courseTitle;\n      // Lưu vào localStorage\n      localStorage.setItem(\"course\", JSON.stringify(action.payload));\n    },\n    clearCourse: (state) => {\n      state.courseId = null;\n      state.courseTitle = \"\";\n      localStorage.removeItem(\"course\");\n    },\n  },\n});\n\nexport const { setCourse, clearCourse } = courseSlice.actions;\nexport default courseSlice.reducer;\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAOA,MAAM,eAA4B;IAChC,UAAU;IACV,aAAa;AACf;AAEA,MAAM,cAAc,IAAA,qPAAW,EAAC;IAC9B,MAAM;IACN;IACA,UAAU;QACR,WAAW,CACT,OACA;YAEA,MAAM,QAAQ,GAAG,OAAO,OAAO,CAAC,QAAQ;YACxC,MAAM,WAAW,GAAG,OAAO,OAAO,CAAC,WAAW;YAC9C,uBAAuB;YACvB,aAAa,OAAO,CAAC,UAAU,KAAK,SAAS,CAAC,OAAO,OAAO;QAC9D;QACA,aAAa,CAAC;YACZ,MAAM,QAAQ,GAAG;YACjB,MAAM,WAAW,GAAG;YACpB,aAAa,UAAU,CAAC;QAC1B;IACF;AACF;AAEO,MAAM,EAAE,SAAS,EAAE,WAAW,EAAE,GAAG,YAAY,OAAO;uCAC9C,YAAY,OAAO","debugId":null}},
    {"offset": {"line": 206, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/features/cart/cartSlice.ts"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport { fetchCartThunk } from \"./cartThunk\";\n\ninterface CartState {\n  items: number[];\n}\n\nconst initialState: CartState = {\n  items: [],\n};\n\nconst cartSlice = createSlice({\n  name: \"cart\",\n  initialState,\n  reducers: {\n    setCart: (state, action) => {\n      state.items = action.payload;\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchCartThunk.fulfilled, (state, action) => {\n      state.items = action.payload;\n    });\n  },\n});\n\nexport const { setCart } = cartSlice.actions;\nexport default cartSlice.reducer;\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAMA,MAAM,eAA0B;IAC9B,OAAO,EAAE;AACX;AAEA,MAAM,YAAY,IAAA,qPAAW,EAAC;IAC5B,MAAM;IACN;IACA,UAAU;QACR,SAAS,CAAC,OAAO;YACf,MAAM,KAAK,GAAG,OAAO,OAAO;QAC9B;IACF;IACA,eAAe,CAAC;QACd,QAAQ,OAAO,CAAC,iMAAc,CAAC,SAAS,EAAE,CAAC,OAAO;YAChD,MAAM,KAAK,GAAG,OAAO,OAAO;QAC9B;IACF;AACF;AAEO,MAAM,EAAE,OAAO,EAAE,GAAG,UAAU,OAAO;uCAC7B,UAAU,OAAO","debugId":null}},
    {"offset": {"line": 239, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/redux/store.ts"],"sourcesContent":["// redux/store.ts\nimport { configureStore } from \"@reduxjs/toolkit\";\n\n// Import các slice\nimport authReducer from \"@/features/auth/authSlice\";\nimport courseReducer from \"@/features/course/courseSlice\";\nimport cartReducer from \"@/features/cart/cartSlice\";\n\nexport const store = configureStore({\n  reducer: {\n    auth: authReducer,\n    course: courseReducer,\n    cart: cartReducer,\n  },\n  devTools: true,\n});\n\n// Khai báo type cho TypeScript\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppDispatch = typeof store.dispatch;\n"],"names":[],"mappings":"AAAA,iBAAiB;;;;;AACjB;AAEA,mBAAmB;AACnB;AACA;AACA;;;;;AAEO,MAAM,QAAQ,IAAA,wPAAc,EAAC;IAClC,SAAS;QACP,MAAM,0LAAW;QACjB,QAAQ,8LAAa;QACrB,MAAM,0LAAW;IACnB;IACA,UAAU;AACZ","debugId":null}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":["file:///Users/hoangvietanh/Documents/CourseDemy/front-end/src/redux/provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { Provider } from \"react-redux\";\nimport { store } from \"./store\";\nimport { setCredentials } from \"@/features/auth/authSlice\";\nimport { useEffect } from \"react\";\nimport { useRouter, usePathname } from \"next/navigation\";\nimport { setCourse } from \"@/features/course/courseSlice\";\nimport { setCart } from \"@/features/cart/cartSlice\";\nimport { fetchCartThunk } from \"@/features/cart/cartThunk\";\n\nexport function ReduxProvider({ children }: { children: React.ReactNode }) {\n  const router = useRouter();\n  const pathname = usePathname(); // Lấy đường dẫn hiện tại\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    const user = localStorage.getItem(\"user\");\n\n    // Chỉ redirect nếu đang ở trang root hoặc login\n    const isAtRootOrLogin = pathname === \"/\" || pathname === \"/login\";\n\n    if (token && user) {\n      const parsedUser = JSON.parse(user);\n      store.dispatch(setCredentials({ token, user: JSON.parse(user) }));\n\n      // Fetch lại giỏ hàng khi load trang\n      store.dispatch(fetchCartThunk({ userId: parsedUser.id, token }));\n\n      if (isAtRootOrLogin) {\n        router.push(\"/home\");\n      }\n    }\n  }, [pathname, router]);\n\n  // Set lại course redux khi load trang\n  useEffect(() => {\n    const courseData = localStorage.getItem(\"course\");\n    if (courseData) {\n      const parsed = JSON.parse(courseData);\n      store.dispatch(setCourse(parsed));\n    }\n  }, []);\n\n  return <Provider store={store}>{children}</Provider>;\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AATA;;;;;;;;;AAWO,SAAS,cAAc,EAAE,QAAQ,EAAiC;IACvE,MAAM,SAAS,IAAA,0LAAS;IACxB,MAAM,WAAW,IAAA,4LAAW,KAAI,yBAAyB;IAEzD,IAAA,6PAAS,EAAC;QACR,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,MAAM,OAAO,aAAa,OAAO,CAAC;QAElC,gDAAgD;QAChD,MAAM,kBAAkB,aAAa,OAAO,aAAa;QAEzD,IAAI,SAAS,MAAM;YACjB,MAAM,aAAa,KAAK,KAAK,CAAC;YAC9B,yKAAK,CAAC,QAAQ,CAAC,IAAA,iMAAc,EAAC;gBAAE;gBAAO,MAAM,KAAK,KAAK,CAAC;YAAM;YAE9D,oCAAoC;YACpC,yKAAK,CAAC,QAAQ,CAAC,IAAA,iMAAc,EAAC;gBAAE,QAAQ,WAAW,EAAE;gBAAE;YAAM;YAE7D,IAAI,iBAAiB;gBACnB,OAAO,IAAI,CAAC;YACd;QACF;IACF,GAAG;QAAC;QAAU;KAAO;IAErB,sCAAsC;IACtC,IAAA,6PAAS,EAAC;QACR,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,IAAI,YAAY;YACd,MAAM,SAAS,KAAK,KAAK,CAAC;YAC1B,yKAAK,CAAC,QAAQ,CAAC,IAAA,gMAAS,EAAC;QAC3B;IACF,GAAG,EAAE;IAEL,qBAAO,yRAAC,gNAAQ;QAAC,OAAO,yKAAK;kBAAG;;;;;;AAClC","debugId":null}}]
}